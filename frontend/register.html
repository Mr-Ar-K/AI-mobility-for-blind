<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Voice Guided Register</title>
<style>
    body { 
        font-family: Arial, sans-serif; 
        background-color: #A898BF;
        display: flex; 
        justify-content: center; 
        align-items: center; 
        height: 100vh; 
        margin: 0; 
    }
    .container { 
        max-width: 900px; 
        background-color: #003366; 
        color: white; 
        padding: 30px; 
        border-radius: 15px; 
        display: flex; 
        justify-content: space-around; 
        box-shadow: 0 8px 20px rgba(0,0,0,0.3); 
    }
    .photo-section { 
        flex: 1; 
        text-align: center; 
    }
    .photo-section img { 
        width: 200px; 
        height: 200px; 
        border-radius: 50%; 
        border: 3px solid white; 
        margin-bottom: 15px; 
        object-fit: cover; 
        display: block;
        margin-left: auto;    /* <-- Add */
        margin-right: auto;   /* <-- Add */
    }
    .form-section { 
        flex: 1; 
        text-align: left; 
        padding-left: 20px; 
    }
    .form-section h1 { 
        text-align: center; 
        margin-bottom: 20px; 
    }
    .form-section input { 
        width: 100%; 
        padding: 10px; 
        margin: 10px 0; 
        border-radius: 8px; 
        border: none; 
    }
    .form-section button { 
        width: 100%; 
        padding: 10px; 
        background-color: #d78c42; 
        color: white; 
        border: none; 
        border-radius: 8px; 
        margin-top: 15px; 
        cursor: pointer; 
        font-size: 16px;
    }
    .form-section button:hover {
        background-color: #379e0b;
    }
</style>
</head>
<body>

<div class="container">
    <div class="photo-section">
        <img id="profilePhoto" src="https://imgs.search.brave.com/rXjxpjdIfB2ywkHOMsqoRG0hS3opNqAPz-wCCUgufs0/rs:fit:500:0:1:0/g:ce/aHR0cHM6Ly9pLnBp/bmltZy5jb20vb3Jp/Z2luYWxzLzUzLzdj/LzhhLzUzN2M4YTc1/ZjAxNTk4ZWI3NTU5/NTUyZjRjNGIwZGM3/LmpwZw" alt="Profile Photo">
        <input type="file" id="photoInput" onchange="previewPhoto(event)">
        <p>Upload your photo</p>
    </div>
    <div class="form-section">
        <h1>Register</h1>
        <input type="text" id="firstName" placeholder="First Name">
        <input type="text" id="lastName" placeholder="Last Name">
        <input type="text" id="username" placeholder="Username">
        <input type="password" id="password" placeholder="Password">
        <input type="tel" id="phone" placeholder="Phone Number">
        <input type="email" id="email" placeholder="Email">
        <button onclick="manualRegister()">Register</button>
    </div>
</div>

<script>
// ---------- Voice Synthesis ----------
function speak(text, callback) {
    speechSynthesis.cancel();
    const utter = new SpeechSynthesisUtterance(text);
    utter.rate = 1;
    utter.onend = callback;
    speechSynthesis.speak(utter);
}

// ---------- Voice Recognition ----------
function listenOnce(callback) {
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (!SpeechRecognition) {
        alert("Your browser does not support Speech Recognition.");
        return;
    }
    const recognition = new SpeechRecognition();
    recognition.lang = 'en-US';
    recognition.interimResults = false;
    recognition.maxAlternatives = 1;

    recognition.onresult = (event) => {
        let speechResult = event.results[0][0].transcript.trim();
        console.log("Heard:", speechResult);
        callback(speechResult);
    };

    recognition.onerror = (event) => {
        console.log("Error:", event.error);
        callback("");
    };

    recognition.start();
}

// ---------- Photo Preview ----------
function previewPhoto(event) {
    const reader = new FileReader();
    reader.onload = function(){
        document.getElementById('profilePhoto').src = reader.result;
    };
    reader.readAsDataURL(event.target.files[0]);
}
// ---------- Fields Configuration ----------
const fields = [
    {id: 'firstName', prompt: 'Say your first name'},
    {id: 'lastName', prompt: 'Say your last name'},
    {id: 'username', prompt: 'Say your username'},
    {id: 'password', prompt: 'Say your password or type it manually'},
    {id: 'phone', prompt: 'Say your phone number'},
    {id: 'email', prompt: 'Say your email'}
];

let currentField = 0;

// ---------- Clear All Fields ----------
function clearFields() {
    fields.forEach(f => document.getElementById(f.id).value = "");
    document.getElementById('photoInput').value = "";
    document.getElementById('profilePhoto').src = "https://via.placeholder.com/200";
}

// ---------- Voice-guided Input ----------
function nextField() {
    if (currentField >= fields.length) {
        speak("All fields detected. Say Register or click the button to continue.", () => {
            listenRegisterCommand();
        });
        return;
    }

    const field = fields[currentField];
    speak(field.prompt, () => {
        listenOnce((text) => {
            if (text) document.getElementById(field.id).value = text;
            currentField++;
            nextField();
        });
    });
}

// ---------- Handle Register Command (Voice) ----------
function listenRegisterCommand() {
    listenOnce((text) => {
        if (text.toLowerCase().includes("register")) {
            checkAndSubmit();
        } else {
            speak("Please say Register when you are ready.", () => {
                listenRegisterCommand();
            });
        }
    });
}

// ---------- Handle Manual Button Click ----------
function manualRegister() {
    checkAndSubmit();
}

// ---------- Check Fields and Submit ----------
function checkAndSubmit() {
    let emptyFields = fields.filter(f => !document.getElementById(f.id).value.trim());
    if (emptyFields.length > 0) {
        speak("Fill all fields. Let's start again from first name.", () => {
            clearFields();
            currentField = 0;
            nextField();
        });
        return;
    }
    speak("Registered successfully!");
    submitRegister();
}

// ---------- Submit Registration ----------
function submitRegister() {
    const data = {};
    fields.forEach(f => data[f.id] = document.getElementById(f.id).value);
    data.photo = document.getElementById('photoInput').files[0] ? document.getElementById('photoInput').files[0].name : "No photo";
    console.log("Registered Data:", data);
    window.location.href = "homepage.html";
}

// ---------- Start on Load ----------
window.onload = () => {
    speak("This is the register section.", () => {
        nextField();
    });
};
</script>
</body>
</html>
